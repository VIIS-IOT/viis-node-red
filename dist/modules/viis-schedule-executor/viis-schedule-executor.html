<script type="text/html" data-template-name="viis-schedule-executor">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-clock-o"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Schedule Executor">
    </div>
    <div class="form-row">
        <label for="node-input-mqttBroker"><i class="fa fa-exchange"></i> MQTT Broker</label>
        <select id="node-input-mqttBroker">
            <option value="thingsboard">ThingsBoard</option>
            <option value="local">EMQX Local</option>
        </select>
    </div>
    <div class="form-row">
        <label for="node-input-scheduleInterval"><i class="fa fa-clock-o"></i> Schedule Check Interval (seconds)</label>
        <input type="number" id="node-input-scheduleInterval" placeholder="10" min="1">
    </div>
    <div class="form-row">
        <label for="node-input-description"><i class="fa fa-info-circle"></i> Description</label>
        <input type="text" id="node-input-description" placeholder="Optional description">
    </div>
</script>

<script type="text/javascript">
    RED.nodes.registerType('viis-schedule-executor', {
        category: 'function',
        color: "#a6bbcf",
        defaults: {
            name: { value: "" },
            mqttBroker: { value: "thingsboard", required: true },
            scheduleInterval: { value: 10, required: true },
            description: { value: "" }
        },
        inputs: 1,
        outputs: 1,
        icon: "../../icons/logo.png",
        label: function () {
            return this.name || "viis-schedule-executor";
        },
        oneditprepare: function () {
            // Bạn có thể thêm code oneditprepare nếu cần thiết,
            // ví dụ: thiết lập CodeMirror cho textarea hay xử lý các giá trị mặc định.
        },
        oneditsave: function () {
            // Code để xử lý trước khi lưu cấu hình nếu cần.
        }
    });
</script>

<script type="text/html" data-help-name="viis-schedule-executor">
    <p>
        The <b>VIIS Schedule Executor</b> node is designed to process scheduled actions.
        It reads schedules from the database, checks if they are due based on the defined time range,
        maps schedule actions to Modbus commands, executes these commands (with retry and verification),
        and synchronizes schedule status with MQTT notifications and backend logs.
    </p>
    <p>
        <b>MQTT Broker:</b> Choose between ThingsBoard and EMQX Local.
    </p>
    <p>
        <b>Schedule Check Interval:</b> The interval (in seconds) at which the node checks for due schedules.
    </p>
    <p>
        <b>Description:</b> An optional field to provide additional information about this node.
    </p>
</script>